@page "/NumberMemory"

@using Frontend.Games.NumberMemory

<PageTitle>NumberMemory</PageTitle>

<h2>High Score: @Manager.HighScore</h2>
<h2>Current Score: @Manager.Score</h2>

<div class="game-container" @ref="GameElement" @onkeydown="HandleKeyPress" tabindex="0">
    @if (Manager.GameOver)
    {
        <h3>Game Over</h3>
        <p>Your Score: @Manager.Score</p>
        <button class="button" @onclick="Manager.StartNewGame">Start New Game</button>
    }
    else
    {
        @if (Manager.ShowNumber)
        {
            <p class="number-display">@Manager.CurrentNumber</p>
        }
        else
        {
            <input class="input-box" @ref="InputElement" value="@Manager.UserInput"
                @oninput="e => Manager.UserInput = e.Value?.ToString() ?? string.Empty" placeholder="Enter the number" />
            <button class="button" @onclick="Manager.CheckUserInput">Submit</button>
        }
    }
</div>

<div class="game-rules"
     style="margin-top: 20px;">
    <h3>Rules:</h3>
    <p>Remember the numbers that appear on the screen.</p>
    <p>After the numbers disappear, enter the numbers in the order they appeared.</p>
    <p>Get as many correct as you can!</p>
</div>
@code {
    protected ElementReference InputElement;
    protected ElementReference GameElement;
    private async Task HandleKeyPress(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            if (!Manager.GameOver)
            {
                await Manager.CheckUserInput();
            }
            else
            {
                await Manager.StartNewGame();
            }
        }
    }
}
